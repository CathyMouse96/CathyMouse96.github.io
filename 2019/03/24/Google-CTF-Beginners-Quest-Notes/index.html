<!DOCTYPE html>
<html lang="">

<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">

    
      <link rel="icon" href="/favicon.ico">
    

    <title>
        
          Google CTF Beginners Quest Notes - CMouse&#39;s Blog
        
    </title>

    <!-- Spectre.css framework -->
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-exp.min.css">
    <link rel="stylesheet" href="https://unpkg.com/spectre.css/dist/spectre-icons.min.css">

    <!-- Noto Sans TC -->
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+TC" rel="stylesheet">
    <!-- Noto Sans SC -->
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+SC" rel="stylesheet">
    <!-- Noto Sans -->
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">

    <!-- theme css & js -->
    <link rel="stylesheet" href="/css/book.css">
    <script src="/js/book.js"></script>

    <!-- tocbot -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    
    <!-- katex -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">

    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/zooming/2.1.1/zooming.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const zooming = new Zooming()
    zooming.listen('img')
})
</script>

</head>

<body>

<div class="container">
  <div class="book-container">
    <div class="columns">
      <div class="column col-2 hide-lg">
        <div class="book-sidebar">
  <h4 class="site-meta">
    <a href="/">CMouse&#39;s Blog</a>
  </h4>
  <div class="sidebar-content">
    <ul>
<li><a href="/">Home</a></li>
<li><a href="/2019/12/02/picoctf/README">picoCTF 2019</a><ul>
<li><a href="/2019/11/19/picoctf/whitepages">WhitePages</a></li>
<li><a href="/2019/12/02/picoctf/c0rrupt">c0rrupt</a></li>
<li><a href="/2019/12/02/picoctf/asm3">asm3</a></li>
<li><a href="/2019/12/02/picoctf/asm4">asm4</a></li>
</ul>
</li>
<li>CyberForce 2019<ul>
<li><a href="/2019/12/02/cyberforce/CyberForce-2019-Recap-Cathy">Cathy’s Recap</a></li>
</ul>
</li>
<li><a href="/2019/12/02/Weird-CS-Doodles">Weird CS Doodles</a></li>
</ul>

  </div>
</div>

<script src="/js/book-sidebar.js"></script>

<script>
collapse_sidebar(2)
highlight_tab()
show_sidebar()
</script>
      </div>

      <div class="column col-8 col-lg-12">
        <div class="book-content">
          <div class="book-navbar">
  <header class="navbar">
  <section class="navbar-section">
    <img class="navbar-icon" src="/favicon.ico">
  </section>
  <section class="navbar-center">
    CMouse&#39;s Blog
  </section>
  <section class="navbar-section">
    <label class="accordion-header c-hand" for="accordion-sidebar">
      <i class="icon icon-menu"></i>
    </label>
  </section>
</header>

<div class="accordion">
  <input type="checkbox" id="accordion-sidebar" name="accordion-checkbox" hidden>
  <div class="accordion-body">
    <ul>
<li><a href="/">Home</a></li>
<li><a href="/2019/12/02/picoctf/README">picoCTF 2019</a><ul>
<li><a href="/2019/11/19/picoctf/whitepages">WhitePages</a></li>
<li><a href="/2019/12/02/picoctf/c0rrupt">c0rrupt</a></li>
<li><a href="/2019/12/02/picoctf/asm3">asm3</a></li>
<li><a href="/2019/12/02/picoctf/asm4">asm4</a></li>
</ul>
</li>
<li>CyberForce 2019<ul>
<li><a href="/2019/12/02/cyberforce/CyberForce-2019-Recap-Cathy">Cathy’s Recap</a></li>
</ul>
</li>
<li><a href="/2019/12/02/Weird-CS-Doodles">Weird CS Doodles</a></li>
</ul>

  </div>
</div>
</div>

<div class="book-post">
  <p>This is my first attempt at CTF and I’m stumbling along with the help of walkthroughs on Google :-) I’m posting my notes as I learn.</p>
<p>SPOILERS ALERT! Do not keep reading if you want to solve the problems on your own.</p>
<p>Link to <a href="https://capturetheflag.withgoogle.com/" target="_blank" rel="noopener">Google CTF</a>.</p>
<a id="more"></a>
<h2 id="Letter"><a href="#Letter" class="headerlink" title="Letter"></a>Letter</h2><p>This is what the first challenge looks like. The username and password are blacked out, but we can still select the text and copy and paste! The flag is CTF{ICanReadDis}.</p>
<p><img src="/images/googlectf/letter.jpeg" alt=""></p>
<h2 id="OCR-IS-COOL"><a href="#OCR-IS-COOL" class="headerlink" title="OCR IS COOL!"></a>OCR IS COOL!</h2><p>The attachment is a screenshot like this. The text is gibberish, but we notice something suspicious: VMY{vtxltkvbiaxkbltlnulmbmnmbhgvbiaxk}. The format is suspiciously similar to our flag format: CTF{…}.</p>
<p><img src="/images/googlectf/ocr_is_cool.jpeg" alt=""></p>
<p>So lets say V stands for C, M stands for T and Y stands for F. Since this is an email, we can guess that it begins with “Dear xxx”. So we further guess that W stands for D, X stands for E, T stands for A and K stands for R.</p>
<p>When we write it out, we find that it actually is the Caesar cipher. Here, every letter x is substituted by x + 19. We recover the original flag, which is CTF{caesarcipherisasubstitutioncipher}. (In hindsight, the hint “Caesar once said, don’t stab me…” makes sense!)</p>
<h2 id="Security-by-obscurity"><a href="#Security-by-obscurity" class="headerlink" title="Security by obscurity"></a>Security by obscurity</h2><h2 id="Floppy"><a href="#Floppy" class="headerlink" title="Floppy"></a>Floppy</h2><p>I was soooo proud when I solved this, even though it is pretty easy, because it is the first challenge I ever solved on my own!</p>
<p>The attachment is what seems like an icon - but isn’t. In fact, it contains two zip files. When we run binwalk on the icon, we get this: </p>
<p><img src="/images/googlectf/floppy.jpeg" alt=""></p>
<p>Yup, not an innocent image! The flag is CTF{qeY80sU6Ktko8BJW}, as we can see.</p>
<h2 id="Floppy2"><a href="#Floppy2" class="headerlink" title="Floppy2"></a>Floppy2</h2><h2 id="JS-SAFE"><a href="#JS-SAFE" class="headerlink" title="JS SAFE"></a>JS SAFE</h2><p>Solved 3/25/2019. Soooo proud again! Though it did take me an ENORMOUS amount of time. Hope I’ll get faster with practice.</p>
<p><img src="/images/googlectf/js_safe_1.jpeg" alt=""></p>
<p>So this time we have a safe like this and its corresponding html file. When we enter the password, <code>open_safe()</code> is called, which in turn calls <code>x(password)</code> to check if the password is valid.</p>
<p><img src="/images/googlectf/js_safe_2.jpeg" alt=""></p>
<p>Let’s take a look at <code>x(password)</code>.</p>
<h2 id="Firmware"><a href="#Firmware" class="headerlink" title="Firmware"></a>Firmware</h2><p>Solved 4/12/2019. The attachment is a large file called <code>challenge.ext4</code>. It is likely filesystem data and we should mount it.</p>
<p>Originally this file was in a shared folder between my host and vm, under <code>/media</code>. When I tried to mount it, I kept getting this error: </p>
<p><code>mount: /mnt/challenge: can&#39;t read superblock on /dev/loop23.</code></p>
<p>Moving the file to <code>~/Documents</code> and then mounting it works. I don’t know why. This cost me some time.</p>
<p>The rest is pretty straightforward: Mount the filesystem (<code>sudo mount ~/Documents/challenge.ext4 /mnt/challenge/</code>), switch to the mount point (<code>cd /mnt/challenge/</code>) and look at the files (<code>ls -al</code>). We see a file <code>.mediapc_backdoor_password.gz</code>. Extracting it gives us <code>.mediapc_backdoor_password</code>, which is a text file storing the flag.</p>
<h2 id="Gatekeeper"><a href="#Gatekeeper" class="headerlink" title="Gatekeeper"></a>Gatekeeper</h2><p>Solved 4/12/2019. The attachment is an ELF executable. Lets try executing the file:</p>
<p><img src="/images/googlectf/gatekeeper_1.jpeg" alt=""></p>
<p>Executing with some random username and password:</p>
<p><img src="/images/googlectf/gatekeeper_2.jpeg" alt=""></p>
<p>Lets see if the username and password are stored somewhere in the code! Use <code>strings gatekeeper</code>:</p>
<p><img src="/images/googlectf/gatekeeper_3.jpeg" alt=""></p>
<p>Among the output we have these. Jackpot? Lets try.</p>
<p><img src="/images/googlectf/gatekeeper_4.jpeg" alt=""></p>
<p>Not quite. But at least we’ve got the username! It’s expected - the stored password would likely be some variant of the actual password, like a hash. But the transformation here should be much simpler than a hash. It’s time to look at the code.</p>
<p>We can use <code>objdump -d gatekeeper</code> to obtain the assembly code of the object file. I won’t go into the details of analysing the assembly code, but we can find that the input password is REVERSED before being compared to the stored password. So we simply have to reverse the stored password, which gives us “I_g0T_m4d_sk1lLz”.</p>
<p>Well, I’m sure you do :-)</p>
<p><img src="/images/googlectf/gatekeeper_5.jpeg" alt=""></p>
<h2 id="MEDIA-DB"><a href="#MEDIA-DB" class="headerlink" title="MEDIA_DB"></a>MEDIA_DB</h2><p>Solved 4/12/2019. </p>
<h2 id="Moar"><a href="#Moar" class="headerlink" title="Moar"></a>Moar</h2><p>Solved 4/12/2019.</p>
<p>Yeeeeeesssss. I’ve finally got this one. Been stuck on it for so long.</p>
<p>So we connect to a network service with <code>nc moar.ctfcompetition.com 1337</code>. It apparently serves the man page of the <code>socat</code> command. I had no idea how to approach this and have actually tried to read the man page. (The hint did say “As the old saying goes, everything you need is in the manual.”)</p>
<p>However, it wasn’t <code>socat</code>‘s man page I should be reading. If we press <code>h</code>, we enter the help page of <code>less</code>, which the service is using to display its pages. I’ve never scrolled down far enough before, but today I did, and I found this:</p>
<p><img src="/images/googlectf/moar_1.jpeg" alt=""></p>
<p>Now this looks destructive. Lets do <code>!ls</code>. We find out we are in <code>/</code>. Then we do <code>!ls /home</code>. We find a directory called <code>moar</code>. Lets do <code>!ls /home/moar</code>. We find a shell script called <code>disable_dmz.sh</code>.</p>
<p>We execute the script and find the flag:</p>
<p><img src="/images/googlectf/moar_2.jpeg" alt=""></p>

</div>


  <div class="book-comments">
    




  </div>


<script src="/js/book-post.js"></script>
        </div>
      </div>

      <div class="column col-2 hide-lg">
        <div class="book-toc">
  <div class="book-tocbot">
  </div>
  <div class="book-tocbot-menu">
    <a class="book-toc-expand" onclick="expand_toc()">Expand all</a>
    <a onclick="go_top()">Back to top</a>
    <a onclick="go_bottom()">Go to bottom</a>
  </div>
</div>

<script>
tocbot.init({
  tocSelector: '.book-tocbot',
  contentSelector: '.book-post',
  headingSelector: 'h1, h2, h3, h4, h5',
  collapseDepth: 2,
  orderedList: false,
  scrollSmooth: false,
});

function expand_toc(){
  var b = document.querySelector(".book-toc-expand");
  tocbot.init({
    tocSelector: '.book-tocbot',
    contentSelector: '.book-post',
    headingSelector: 'h1, h2, h3, h4, h5',
    collapseDepth: 6,
    orderedList: false,
    scrollSmooth: false,
  });
  b.setAttribute("onclick", "collapse_toc()");
  b.innerHTML = "Collapse all"
}

function collapse_toc(){
  var b = document.querySelector(".book-toc-expand");
  tocbot.init({
    tocSelector: '.book-tocbot',
    contentSelector: '.book-post',
    headingSelector: 'h1, h2, h3, h4, h5',
    collapseDepth: 2,
    orderedList: false,
    scrollSmooth: false,
  });
  b.setAttribute("onclick", "expand_toc()");
  b.innerHTML = "Expand all"
}

function go_top() {
  window.scrollTo(0, 0);
}

function go_bottom() {
  window.scrollTo(0, document.body.scrollHeight);
}

</script>
      </div>
    </div>
  </div>
</div>

</body>
</html>
